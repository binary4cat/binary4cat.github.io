<!DOCTYPE html>



 <html class="no-js"> 
<head>
    <title>Spring-AOP极简入门  &middot; Haijd&#39;s Blog </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-language" content="en-us" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Haijd">
    <meta name="description" content="a coder.">
    <meta name="generator" content="Hugo 0.53" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="/css/smooth-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/tomorrow.min.css" />
    

    <style>
        .posts li {
            visibility: hidden;
        }
    </style> 
</head>

<body>

    

    <header>
    <div class="h-wrap">
        
        <div class="typewriter">
            <h1 class="title"><a href="/">Haijd&#39;s Blog</a></h1>
        </div>
        
    </div>
</header>
    <div class="site-wrapper" id="full-wrapper">

        <section class="single-wrap">
            <article class="single-content" itemscope itemtype="//schema.org/BlogPosting">
                <div class="feat">
                    <h5 class="page-date">
                        <time datetime="" itemprop="datePublished">
                    30 May 2018
                   
                    </time>
                    </h5>
                </div>
                <h1 class="page-title" itemprop="name headline">Spring-AOP极简入门</h1>
                <br>
                
                <div>
                    
                    <img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1527701268185&amp;di=7ca52773e094b8ee3c40a78ccdf701d9&amp;imgtype=jpg&amp;src=http%3A%2F%2Fimg3.imgtn.bdimg.com%2Fit%2Fu%3D4172169013%2C464131932%26fm%3D214%26gp%3D0.jpg">
                    
                </div>
                
                <div>
                    <nav id="TableOfContents">
<ul>
<li><a href="#1-apo介绍">1. APO介绍</a>
<ul>
<li><a href="#1-1-简介">1.1. 简介</a></li>
<li><a href="#1-2-aop名词">1.2. AOP名词</a></li>
</ul></li>
<li><a href="#2-java动态代理介绍">2. Java动态代理介绍</a>
<ul>
<li><a href="#2-1-代理模式">2.1. 代理模式</a></li>
<li><a href="#2-2-java中的动态代理">2.2. Java中的动态代理</a></li>
<li><a href="#2-3-代码示例">2.3. 代码示例:</a></li>
</ul></li>
<li><a href="#3-cglib代理">3. CGLib代理</a>
<ul>
<li><a href="#3-1-cglib介绍">3.1. cglib介绍</a></li>
<li><a href="#3-2-cglib与jdk动态代理">3.2. cglib与JDK动态代理</a></li>
<li><a href="#3-3-cglib库实现代理示例">3.3. cglib库实现代理示例：</a></li>
</ul></li>
<li><a href="#4-spring-aop的实现">4. Spring AOP的实现</a>
<ul>
<li><a href="#4-1-使用idea创建一个maven项目-添加下列依赖">4.1. 使用IDEA创建一个Maven项目，添加下列依赖：</a></li>
<li><a href="#4-2-创建代理类-hello">4.2. 创建代理类<code>Hello</code>：</a></li>
<li><a href="#4-3-创建一个增强代码类-myadvice">4.3. 创建一个增强代码类<code>MyAdvice</code>：</a></li>
<li><a href="#4-4-接下来创建一个spring的配置文件-spring-xml">4.4. 接下来创建一个spring的配置文件<code>spring.xml</code></a></li>
<li><a href="#4-5-测试类-testaop">4.5. 测试类<code>TestAop</code>:</a></li>
<li><a href="#4-6-输出">4.6. 输出：</a></li>
</ul></li>
<li><a href="#5-使用注解实现spring-aop">5. 使用注解实现Spring AOP</a></li>
<li><a href="#6-参考资料">6. 参考资料</a></li>
</ul>
</nav>
                </div>
                <hr>
                <div itemprop="articleBody">
                    <h1 id="1-apo介绍">1. APO介绍</h1>

<h2 id="1-1-简介">1.1. 简介</h2>

<p>按照惯例先来一份<a href="https://zh.wikipedia.org/wiki/面向侧面的程序设计">维基百科的解释</a>：</p>

<blockquote>
<p>面向侧面的程序设计（aspect-oriented programming，AOP，又译作面向方面的程序设计、观点导向编程、剖面导向程序设计）是计算机科学中的一个术语，指一种程序设计范型。该范型以一种称为侧面（aspect，又译作方面）的语言构造为基础，侧面是一种新的模块化机制，用来描述分散在对象、类或函数中的横切关注点（crosscutting concern）。</p>
</blockquote>

<p>一句话解释AOP就是：AOP可以在不修改源码的情况下对程序进行增强。</p>

<p>举个栗子：<img src="/image/face/举个栗子.jpg" alt="举个栗子" /></p>

<p>　　用这个简图示范一下AOP的具体使用，可能会更容易理解AOP是什么。</p>

<p>　　假设我们已经完成了所有的Web、Service、Dao层的代码，但是现在程序出了Bug，这时你想到在程序中加入日志，每当程序出现异常，就记录下来异常的信息，方便排查，这样做很对，但是代码已经很多了，不可能在每个Method中都加入一个记录日志的代码，这样做太麻烦了，而且很不优雅。</p>

<p>　　这时候，我们的AOP就上场了，不用改动任何的现有代码，只需加入记录日志操作的代码，并且配置每当程序抛出未捕获(或者任何异常)异常时就记录日志。</p>

<p>　　又或者是，在Service调用Dao层的数据库操作代码前后，加入事务。</p>

<p>　　这里的*日志记录问题*和*事务记录问题*就是<strong>横切关注点</strong>。</p>

<p>　　不破坏现有的业务代码对程序增加功能，这就是AOP存在的意义。</p>

<p><img src="/image/Java/111111.png" alt="AOP演示" /></p>

<h2 id="1-2-aop名词">1.2. AOP名词</h2>

<ul>
<li><code>Joinpoint</code>(连接点)：目标对象中所有可以被增强的方法。</li>
<li><code>Pointcut</code>(切入点)：目标对象中已经被增强的方法。</li>
<li><code>Advice</code>(通知)：用来增强的代码。</li>
<li><code>Target</code>(目标对象)：被代理的对象。</li>
<li><code>Weaving</code>(织入)：将通知(Advice)应用到切入点(Pointcut)的过程。</li>
<li><code>Proxy</code>(代理)：将通知织入到目标对象之后形成代理对象。</li>
<li><code>Aspect</code>(切面)：切入点(Pointcut)<strong>+</strong>(Advice)通知。</li>
</ul>

<h1 id="2-java动态代理介绍">2. Java动态代理介绍</h1>

<h2 id="2-1-代理模式">2.1. 代理模式</h2>

<p>　　介绍Java的动态代理之前，先提一下代理模式，代理模式就是为其他对象提供一种代理，以控制对这个对象的访问。这么说可能不好理解，举个例子：我们现在要租房子，一般都是通过中介公司找房子，而不是直接找房东，在这个过程中中介公司就相当于一个代理(Proxy)，我们(client)并不能直接和房东(bean)联系，而是通过中介的联系，这样的好处就是，房东不用到处找客户，只需要把房子交给中介，自己该干嘛干嘛，而我们只需要找到靠谱的中介，就免去了和房东的一些理不清的纠纷。</p>

<p>　　而程序中的代理，就是为了给我们已经写好的代码增强功能，也就是AOP的具体实现模式。</p>

<h2 id="2-2-java中的动态代理">2.2. Java中的动态代理</h2>

<p>　　动态类型语言入python、ruby等，可以在运行时动态的对类进行修改，而在Java中这是不被允许的，因为Java属于静态类型语言，运行时类已经被编译成字节码，无法对其进行修改(并不绝对，我们接下来介绍的CGLib就是个例外)。</p>

<p>　　为了实现在运行时动态的修改类型定义，Java5引入了一个新特性就是动态代理，而这个特性并不是特别的优雅，Java规定了需要动态代理的类，必须实现接口才行，这样被代理类和动态创建的代理类都会继承该接口，从而实现类的代理。</p>

<h2 id="2-3-代码示例">2.3. 代码示例:</h2>

<p>接口<code>IHello</code>：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> Proxy_1<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">interface</span> <span style="color:#50fa7b">IHello</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">sayHello</span><span style="color:#ff79c6">();</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>被代理对象<code>Hello</code>：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> Proxy_1<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Hello</span> <span style="color:#8be9fd;font-style:italic">implements</span> IHello <span style="color:#ff79c6">{</span>

    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">sayHello</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>代理实现类<code>ProxyHandler</code>：</p>

<p>Java规定，代理实现类必须继承<code>InvocationHandler</code>接口，并且实现其<code>invoke</code>方法。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> Proxy_1<span style="color:#ff79c6">;</span>

<span style="color:#ff79c6">import</span> java.lang.reflect.InvocationHandler<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> java.lang.reflect.Method<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> java.lang.reflect.Proxy<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">ProxyHandler</span> <span style="color:#8be9fd;font-style:italic">implements</span> InvocationHandler <span style="color:#ff79c6">{</span>

    <span style="color:#8be9fd;font-style:italic">private</span> Object target<span style="color:#ff79c6">;</span>
    <span style="color:#6272a4">// 绑定被代理对象，返回代理
</span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">bind</span><span style="color:#ff79c6">(</span>Object target<span style="color:#ff79c6">){</span>
        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">target</span><span style="color:#ff79c6">=</span>target<span style="color:#ff79c6">;</span>
        <span style="color:#6272a4">// 返回生成的代理
</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> Proxy<span style="color:#ff79c6">.</span><span style="color:#50fa7b">newProxyInstance</span><span style="color:#ff79c6">(</span>target<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getClass</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getClassLoader</span><span style="color:#ff79c6">(),</span>target<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getClass</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getInterfaces</span><span style="color:#ff79c6">(),</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
    <span style="color:#6272a4">// 这里就是写扩展代码的地方
</span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">invoke</span><span style="color:#ff79c6">(</span>Object proxy<span style="color:#ff79c6">,</span> Method method<span style="color:#ff79c6">,</span> Object<span style="color:#ff79c6">[]</span> args<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> Throwable <span style="color:#ff79c6">{</span>
        Object result<span style="color:#ff79c6">;</span>

        <span style="color:#6272a4">/*目标方法调用之前*/</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Before sayHello\n&#34;</span><span style="color:#ff79c6">);</span>
        result<span style="color:#ff79c6">=</span>method<span style="color:#ff79c6">.</span><span style="color:#50fa7b">invoke</span><span style="color:#ff79c6">(</span>target<span style="color:#ff79c6">,</span>args<span style="color:#ff79c6">);</span>
        <span style="color:#6272a4">/*目标方法调用之后*/</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;\nAfter sayHello&#34;</span><span style="color:#ff79c6">);</span>

        <span style="color:#ff79c6">return</span> result<span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>测试类<code>TestProxy</code>：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">import</span> Proxy_1.Hello<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> Proxy_1.IHello<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> Proxy_1.ProxyHandler<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">TestProxy</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String args<span style="color:#ff79c6">[]){</span>
        ProxyHandler proxy<span style="color:#ff79c6">=</span><span style="color:#ff79c6">new</span> ProxyHandler<span style="color:#ff79c6">();</span>

        IHello hello<span style="color:#ff79c6">=(</span>IHello<span style="color:#ff79c6">)</span>proxy<span style="color:#ff79c6">.</span><span style="color:#50fa7b">bind</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Hello<span style="color:#ff79c6">());</span>
        hello<span style="color:#ff79c6">.</span><span style="color:#50fa7b">sayHello</span><span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>输出：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Before sayHello
Hello World!
After sayHello</code></pre></td></tr></table>
</div>
</div>
<h1 id="3-cglib代理">3. CGLib代理</h1>

<h2 id="3-1-cglib介绍">3.1. cglib介绍</h2>

<p>　　<a href="https://github.com/cglib/cglib">cglib</a>是一个开源的Java类库，提供了比Java动态代理更加强大的代理功能，cglib不需要动态代理的对象实现任何接口，比起Java自身的动态代理着实好用了许多。</p>

<h2 id="3-2-cglib与jdk动态代理">3.2. cglib与JDK动态代理</h2>

<p>cglib和Java动态代理的主要区别：</p>

<ul>
<li>Java动态代理是利用反射机制生成一个实现代理接口的匿名类，在调用目标方法前调用<code>InvokeHandler</code>来执行一些自定义的处理。</li>
<li>cglib底层使用了一个<code>ASM</code>开源包，直接对代理对象编译后的class文件进行修改，修改其字节码，给代理对象生成一个子类，由子类实现代理功能。</li>
<li>实现方式上，Java动态代理使用的是反射查找指定接口的实现类；cglib是给代理对象生成子类，从而继承其能力，实现代理功能。</li>
<li>如果目标对象被<code>final</code>修饰，那么该类就无法被cglib代理了。</li>
</ul>

<p>两种方式对比，cglib比较方便灵活一些，在spring-aop中两种代理方式都使用到了，默认情况下使用的是Java动态代理，但是如果目标对象没有实现接口，那么必须强制使用cglib库进行代理。</p>

<p>强制使用cglib需要在spring配置中加入：<code>&lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot;/&gt;</code></p>

<h2 id="3-3-cglib库实现代理示例">3.3. cglib库实现代理示例：</h2>

<p>代理对象<code>Hello</code>：</p>

<p>使用cglib不需要实现任何接口。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> dome_1<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Hello</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">sayHello</span><span style="color:#ff79c6">(){</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>Cglib代理类<code>CglibProxyHandler</code>:</p>

<p>需要继承cglib库的<code>MethodInterceptor</code>的<code>intercept</code>方法，该方法类似于JDK代理的<code>invoke</code>方法。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> dome_1<span style="color:#ff79c6">;</span>

<span style="color:#ff79c6">import</span> net.sf.cglib.proxy.Enhancer<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> net.sf.cglib.proxy.MethodInterceptor<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> net.sf.cglib.proxy.MethodProxy<span style="color:#ff79c6">;</span>

<span style="color:#ff79c6">import</span> java.lang.reflect.Method<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">CglibProxyHandler</span> <span style="color:#8be9fd;font-style:italic">implements</span> MethodInterceptor <span style="color:#ff79c6">{</span>

    <span style="color:#6272a4">// 获得一个代理对象实例
</span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">getProxy</span><span style="color:#ff79c6">(</span>Class c<span style="color:#ff79c6">){</span>
        Enhancer enhancer<span style="color:#ff79c6">=</span><span style="color:#ff79c6">new</span> Enhancer<span style="color:#ff79c6">();</span>
        enhancer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSuperclass</span><span style="color:#ff79c6">(</span>c<span style="color:#ff79c6">);</span>
        enhancer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCallback</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">return</span> enhancer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">create</span><span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">}</span>

    @Override
    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">intercept</span><span style="color:#ff79c6">(</span>Object o<span style="color:#ff79c6">,</span> Method method<span style="color:#ff79c6">,</span> Object<span style="color:#ff79c6">[]</span> objects<span style="color:#ff79c6">,</span> MethodProxy methodProxy<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> Throwable <span style="color:#ff79c6">{</span>
        <span style="color:#6272a4">/*目标方法调用之前*/</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Before sayHello\n&#34;</span><span style="color:#ff79c6">);</span>
        Object returnValue <span style="color:#ff79c6">=</span> methodProxy<span style="color:#ff79c6">.</span><span style="color:#50fa7b">invokeSuper</span><span style="color:#ff79c6">(</span>o<span style="color:#ff79c6">,</span> objects<span style="color:#ff79c6">);</span>
        <span style="color:#6272a4">/*目标方法调用之后*/</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">print</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;\nAfter sayHello&#34;</span><span style="color:#ff79c6">);</span>

        <span style="color:#ff79c6">return</span> returnValue<span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>测试类<code>TestProxy</code>:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">import</span> dome_1.CglibProxyHandler<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> dome_1.Hello<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">TestProxy</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String args<span style="color:#ff79c6">[]){</span>
        CglibProxyHandler proxy<span style="color:#ff79c6">=</span><span style="color:#ff79c6">new</span> CglibProxyHandler<span style="color:#ff79c6">();</span>
        <span style="color:#6272a4">// 获得一个代理对象
</span><span style="color:#6272a4"></span>        Hello hello<span style="color:#ff79c6">=(</span>Hello<span style="color:#ff79c6">)</span> proxy<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getProxy</span><span style="color:#ff79c6">(</span>Hello<span style="color:#ff79c6">.</span><span style="color:#50fa7b">class</span><span style="color:#ff79c6">);</span>
        hello<span style="color:#ff79c6">.</span><span style="color:#50fa7b">sayHello</span><span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<p>执行结果：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Before sayHello
Hello World!
After sayHello</code></pre></td></tr></table>
</div>
</div>
<h1 id="4-spring-aop的实现">4. Spring AOP的实现</h1>

<h2 id="4-1-使用idea创建一个maven项目-添加下列依赖">4.1. 使用IDEA创建一个Maven项目，添加下列依赖：</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">&lt;</span>dependencies<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>cglib<span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>cglib<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>3<span style="color:#ff79c6">.</span><span style="color:#50fa7b">2</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">6</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>org<span style="color:#ff79c6">.</span><span style="color:#50fa7b">springframework</span><span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>spring<span style="color:#ff79c6">-</span>context<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>4<span style="color:#ff79c6">.</span><span style="color:#50fa7b">3</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">17</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">RELEASE</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>org<span style="color:#ff79c6">.</span><span style="color:#50fa7b">springframework</span><span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>spring<span style="color:#ff79c6">-</span>aspects<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>4<span style="color:#ff79c6">.</span><span style="color:#50fa7b">3</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">17</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">RELEASE</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>org<span style="color:#ff79c6">.</span><span style="color:#50fa7b">springframework</span><span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>spring<span style="color:#ff79c6">-</span>aop<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>4<span style="color:#ff79c6">.</span><span style="color:#50fa7b">3</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">17</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">RELEASE</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>org<span style="color:#ff79c6">.</span><span style="color:#50fa7b">aspectj</span><span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>aspectjrt<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">9</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">1</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span>dependency<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>groupId<span style="color:#ff79c6">&gt;</span>org<span style="color:#ff79c6">.</span><span style="color:#50fa7b">aspectj</span><span style="color:#ff79c6">&lt;/</span>groupId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>artifactId<span style="color:#ff79c6">&gt;</span>aspectjtools<span style="color:#ff79c6">&lt;/</span>artifactId<span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span>version<span style="color:#ff79c6">&gt;</span>1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">9</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">1</span><span style="color:#ff79c6">&lt;/</span>version<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;/</span>dependency<span style="color:#ff79c6">&gt;</span>
    <span style="color:#ff79c6">&lt;/</span>dependencies<span style="color:#ff79c6">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-2-创建代理类-hello">4.2. 创建代理类<code>Hello</code>：</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> spring_aop<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Hello</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">listen</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Listen Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">speak</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Speak Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">read</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Read Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">write</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Write Hello World!&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-3-创建一个增强代码类-myadvice">4.3. 创建一个增强代码类<code>MyAdvice</code>：</h2>

<p>AOP的五种通知类型：</p>

<p><strong>前置通知</strong>(<code>before</code>) ：在目标方法执行之前执行。
<strong>后置通知</strong>(<code>after-returning</code>) ：在目标方法执行之后执行,出现异常时不会执行。
<strong>环绕通知</strong>(<code>around</code>) ：在目标方法执行前和执行后执行。
<strong>异常抛出通知</strong>(<code>after-throwing</code>)：在目标方法执行出现异常的时候执行。
<strong>最终通知</strong>(<code>after</code>) ：无论目标方法是否出现异常最终通知都会执行。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> spring_aop<span style="color:#ff79c6">;</span>

<span style="color:#ff79c6">import</span> org.aspectj.lang.ProceedingJoinPoint<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyAdvice</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">before</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是前置通知&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">afterReturning</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是后置通知(出现异常不会调用我)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">around</span><span style="color:#ff79c6">(</span>ProceedingJoinPoint pjp<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> Throwable <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是环绕在切入点之前的通知&#34;</span><span style="color:#ff79c6">);</span>
        Object proceed <span style="color:#ff79c6">=</span> pjp<span style="color:#ff79c6">.</span><span style="color:#50fa7b">proceed</span><span style="color:#ff79c6">();</span>   <span style="color:#6272a4">// 调用目标方法
</span><span style="color:#6272a4"></span>        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是环绕在切入点之后的通知&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">return</span> proceed<span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>

    <span style="color:#6272a4">// 程序抛出异常的时候，会调用该方法，可以在此收集日志。
</span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">afterException</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;出现异常啦！！！&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">after</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是后置通知(出现异常也会调用我)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-4-接下来创建一个spring的配置文件-spring-xml">4.4. 接下来创建一个spring的配置文件<code>spring.xml</code></h2>

<p>切点表达式简介(针对下面的表达式解释，具体请查阅网络更详细的解释)：</p>

<table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"><code>execution()</code></td>
<td align="left">表示切点表达式的主体</td>
</tr>

<tr>
<td align="left">第一个<code>*</code></td>
<td align="left">表示返回值，<code>*</code>表示任意返回值</td>
</tr>

<tr>
<td align="left">spring_aop.Hello</td>
<td align="left">切点所在的类名，需要完全限定名</td>
</tr>

<tr>
<td align="left">包名后的<code>.</code></td>
<td align="left">表示当前类(包)，<code>..</code>两个点就表示当前的包和子包</td>
</tr>

<tr>
<td align="left">第二个<code>*</code></td>
<td align="left">表示该类下所有的方法</td>
</tr>

<tr>
<td align="left"><code>(..)</code></td>
<td align="left">表示方法可以有任意参数</td>
</tr>
</tbody>
</table>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">&lt;?</span>xml version<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;1.0&#34;</span> encoding<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span><span style="color:#ff79c6">?&gt;</span>
<span style="color:#ff79c6">&lt;</span>beans xmlns<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/beans&#34;</span><span style="color:#8be9fd;font-style:italic">
</span><span style="color:#8be9fd;font-style:italic">       xmlns:</span>xsi<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#8be9fd;font-style:italic">xmlns:</span>aop<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/aop&#34;</span><span style="color:#8be9fd;font-style:italic">
</span><span style="color:#8be9fd;font-style:italic">       xsi:</span>schemaLocation<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style="color:#ff79c6">&gt;</span>

    <span style="color:#ff79c6">&lt;</span>bean name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;hello&#34;</span> class<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;spring_aop.Hello&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>bean<span style="color:#ff79c6">&gt;</span>
    <span style="color:#ff79c6">&lt;</span>bean name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;myAdvice&#34;</span> class<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;spring_aop.MyAdvice&#34;</span><span style="color:#ff79c6">&gt;&lt;/</span>bean<span style="color:#ff79c6">&gt;</span>

    <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>config<span style="color:#ff79c6">&gt;</span>
        <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>pointcut id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span> expression<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;execution(* spring_aop.Hello.*(..))&#34;</span><span style="color:#ff79c6">/&gt;</span>
        <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>aspect ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;myAdvice&#34;</span><span style="color:#ff79c6">&gt;</span>
            <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>before method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;before&#34;</span> pointcut<span style="color:#ff79c6">-</span>ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span><span style="color:#ff79c6">/&gt;</span>
            <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>after<span style="color:#ff79c6">-</span>returning method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;afterReturning&#34;</span> pointcut<span style="color:#ff79c6">-</span>ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span><span style="color:#ff79c6">/&gt;</span>
            <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>around method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;around&#34;</span> pointcut<span style="color:#ff79c6">-</span>ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span><span style="color:#ff79c6">/&gt;</span>
            <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>after<span style="color:#ff79c6">-</span>throwing method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;afterException&#34;</span> pointcut<span style="color:#ff79c6">-</span>ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span><span style="color:#ff79c6">/&gt;</span>
            <span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">aop:</span>after method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;after&#34;</span> pointcut<span style="color:#ff79c6">-</span>ref<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;muSay&#34;</span><span style="color:#ff79c6">/&gt;</span>
        <span style="color:#ff79c6">&lt;/</span><span style="color:#8be9fd;font-style:italic">aop:</span>aspect<span style="color:#ff79c6">&gt;</span>
    <span style="color:#ff79c6">&lt;/</span><span style="color:#8be9fd;font-style:italic">aop:</span>config<span style="color:#ff79c6">&gt;</span>
<span style="color:#ff79c6">&lt;/</span>beans<span style="color:#ff79c6">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-5-测试类-testaop">4.5. 测试类<code>TestAop</code>:</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">import</span> org.springframework.context.support.ClassPathXmlApplicationContext<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> spring_aop.Hello<span style="color:#ff79c6">;</span>

<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">TestAop</span> <span style="color:#ff79c6">{</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String args<span style="color:#ff79c6">[]){</span>
        <span style="color:#6272a4">//1 创建容器对象
</span><span style="color:#6272a4"></span>        ClassPathXmlApplicationContext ac<span style="color:#ff79c6">;</span>
        ac <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ClassPathXmlApplicationContext<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;spring.xml&#34;</span><span style="color:#ff79c6">);</span>

        <span style="color:#6272a4">// 从容器中获取bean
</span><span style="color:#6272a4"></span>        Hello hello<span style="color:#ff79c6">=(</span>Hello<span style="color:#ff79c6">)</span>ac<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBean</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;hello&#34;</span><span style="color:#ff79c6">);</span>
        hello<span style="color:#ff79c6">.</span><span style="color:#50fa7b">listen</span><span style="color:#ff79c6">();</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;*****************&#34;</span><span style="color:#ff79c6">);</span>
        hello<span style="color:#ff79c6">.</span><span style="color:#50fa7b">speak</span><span style="color:#ff79c6">();</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-6-输出">4.6. 输出：</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">我是前置通知
我是环绕在切入点之前的通知
Listen Hello World!
我是后置通知<span style="color:#ff79c6">(</span>出现异常也会调用我<span style="color:#ff79c6">)</span>
我是环绕在切入点之后的通知
我是后置通知<span style="color:#ff79c6">(</span>出现异常不会调用我<span style="color:#ff79c6">)</span>
*****************
我是前置通知
我是环绕在切入点之前的通知
Speak Hello World!
我是后置通知<span style="color:#ff79c6">(</span>出现异常也会调用我<span style="color:#ff79c6">)</span>
我是环绕在切入点之后的通知
我是后置通知<span style="color:#ff79c6">(</span>出现异常不会调用我<span style="color:#ff79c6">)</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="5-使用注解实现spring-aop">5. 使用注解实现Spring AOP</h1>

<p>使用注解则省去了spring中的<code>aop:config</code>配置，只需要增加一个使用注解的配置<code>&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code>即可：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#ff79c6">&lt;beans</span> <span style="color:#50fa7b">xmlns=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span style="color:#50fa7b">xmlns:xsi=</span><span style="color:#f1fa8c">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#50fa7b">xmlns:aop=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/aop&#34;</span>
       <span style="color:#50fa7b">xsi:schemaLocation=</span><span style="color:#f1fa8c">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style="color:#ff79c6">&gt;</span>
    <span style="color:#6272a4">&lt;!-- 配置通知对象 --&gt;</span>
    <span style="color:#ff79c6">&lt;bean</span> <span style="color:#50fa7b">name=</span><span style="color:#f1fa8c">&#34;hello&#34;</span> <span style="color:#50fa7b">class=</span><span style="color:#f1fa8c">&#34;spring_aop.Hello&#34;</span><span style="color:#ff79c6">&gt;&lt;/bean&gt;</span>
    <span style="color:#6272a4">&lt;!-- 配置通知对象 --&gt;</span>
    <span style="color:#ff79c6">&lt;bean</span> <span style="color:#50fa7b">name=</span><span style="color:#f1fa8c">&#34;myAdvice&#34;</span> <span style="color:#50fa7b">class=</span><span style="color:#f1fa8c">&#34;spring_aop.MyAdvice&#34;</span><span style="color:#ff79c6">&gt;&lt;/bean&gt;</span>
    <span style="color:#6272a4">&lt;!-- 开启使用注解 --&gt;</span>
    <span style="color:#ff79c6">&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span>
<span style="color:#ff79c6">&lt;/beans&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>在<code>MyAdvice</code>类中使用注解标记各个通知即可：</p>

<ul>
<li><code>@Aspect</code>表示这个类是一个通知类。</li>
<li><code>@Pointcut</code>可以标记一个空方法，当通知类里面的切点表达式相同时，可以定义一个公用的切点表达式方法，在其他注解就可以直接使用该方法的完全限定名了。</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ff79c6">package</span> spring_aop<span style="color:#ff79c6">;</span>

<span style="color:#ff79c6">import</span> org.aspectj.lang.ProceedingJoinPoint<span style="color:#ff79c6">;</span>
<span style="color:#ff79c6">import</span> org.aspectj.lang.annotation.*<span style="color:#ff79c6">;</span>

@Aspect
<span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyAdvice</span> <span style="color:#ff79c6">{</span>
    <span style="color:#6272a4">// 定义一个公用的切点表达式
</span><span style="color:#6272a4"></span>    @Pointcut<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;execution(* spring_aop.Hello.*(..))&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">expression</span><span style="color:#ff79c6">(){}</span>


    @Before<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;spring_aop.MyAdvice.expression()&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">before</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是前置通知&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
    @AfterReturning<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;spring_aop.MyAdvice.expression()&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">afterReturning</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是后置通知(出现异常不会调用我)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
    @Around<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;execution(* spring_aop.Hello.*(..))&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> Object <span style="color:#50fa7b">around</span><span style="color:#ff79c6">(</span>ProceedingJoinPoint pjp<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> Throwable <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是环绕在切入点之前的通知&#34;</span><span style="color:#ff79c6">);</span>
        Object proceed <span style="color:#ff79c6">=</span> pjp<span style="color:#ff79c6">.</span><span style="color:#50fa7b">proceed</span><span style="color:#ff79c6">();</span>   <span style="color:#6272a4">// 调用目标方法
</span><span style="color:#6272a4"></span>        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是环绕在切入点之后的通知&#34;</span><span style="color:#ff79c6">);</span>
        <span style="color:#ff79c6">return</span> proceed<span style="color:#ff79c6">;</span>
    <span style="color:#ff79c6">}</span>
    @AfterThrowing<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;execution(* spring_aop.Hello.*(..))&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">afterException</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;出现异常啦！！！&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
    @After<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;execution(* spring_aop.Hello.*(..))&#34;</span><span style="color:#ff79c6">)</span>
    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">after</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
        System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;我是后置通知(出现异常也会调用我)&#34;</span><span style="color:#ff79c6">);</span>
    <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="6-参考资料">6. 参考资料</h1>

<p><a href="https://zh.wikipedia.org/wiki/面向侧面的程序设计">https://zh.wikipedia.org/wiki/面向侧面的程序设计</a>
<a href="https://baike.baidu.com/item/Aspectj">https://baike.baidu.com/item/Aspectj</a>
<a href="https://blog.csdn.net/ABCD898989/article/details/50809321">https://blog.csdn.net/ABCD898989/article/details/50809321</a>
《Spring实战第四版》</p>
                </div>
                <div class="feat share">
                </div>

                <div id="disqus_thread"></div>
<script>
    

    

    (function() { 
        var d = document,
            s = d.createElement('script');

        s.src = 'https://HaijdBlog.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

            </article>
        </section>

        <footer>
	
	<small>Haijd</small>
	
</footer>
    </div>

    <div class="next-prev-arrows">
        
        <a rel="next" href="/java/spring-core-annotationss/" id="next">
                &larr; <span class="nav-title nav-title-next">Spring Core Annotations</span> 
            </a>  
        <a rel="prev" href="/java/java-compareto%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%AF%94%E8%BE%83%E5%87%BD%E6%95%B0/" id="prev">
            <span class="nav-title nav-title-prev">Java compareTo字符串比较函数</span> &rarr;
        </a>
        
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="/js/scrollreveal.min.js"></script>
<script type='application/javascript' src='/js/smooth-scrollbar.js'></script>
<script src="/js/baffle.min.js"></script>
<script src="/js/main.js"></script>
 
</body>

</html>